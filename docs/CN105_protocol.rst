CN105 Protocol
**************

My Air Conditioning System uses the Mitsubishi CN105 protocol.
It is based on UART (2400 8E1).

There seem to be several different versions of this protocol. My AC (MSZ-HR25/35VF) works with this implementation.

Format
======

+------------+-------------+------------+----------------+----------------+-----------------------------+
| Start Byte | Packet Type | Header     | Payload Length | Payload        | Checksum                    |
+============+=============+============+================+================+=============================+
| 0xFC       | 1 Byte      | 0x01, 0x30 | 1 Byte         | up to 16 Bytes | 0xFC - (Sum(Packet) & 0xFF) |
+------------+-------------+------------+----------------+----------------+-----------------------------+

Packet Types
============

+------------------+-------+-------------------------------------+
| Type             | Value | Description                         |
+==================+=======+=====================================+
| Connect Request  | 0x5A  | Initiate Communication with AC      |
+------------------+-------+-------------------------------------+
| Connect Response | 0x7A  | Response from AC on Connect Request |
+------------------+-------+-------------------------------------+
| Get Request      | 0x42  | Request Readings from AC            |
+------------------+-------+-------------------------------------+
| Get Responses    | 0x62  | Response from AC on Get Request     |
+------------------+-------+-------------------------------------+
| Set Request      | 0x41  | Set State to AC                     |
+------------------+-------+-------------------------------------+
| Set Response     | 0x41  | Response from AC on Set Request     |
+------------------+-------+-------------------------------------+

Connect
-------

Initiate the communication with the AC:

+-----------+------------+-------------+------------+----------------+------------+----------+
| Direction | Start Byte | Packet Type | Header     | Payload Length | Payload    | Checksum |
+===========+============+=============+============+================+============+==========+
| to AC     | 0xFC       | 0x5A        | 0x01, 0x30 | 0x02           | 0xCA, 0x01 | 0xA8     |
+-----------+------------+-------------+------------+----------------+------------+----------+
| from AC   | 0xFC       | 0x7A        | 0x01, 0x30 | 0x01           | 0x00       | 0x54     |
+-----------+------------+-------------+------------+----------------+------------+----------+


Get Data
--------

Get Readings from AC:

+-----------+------------+-------------+------------+----------------+----------+-----------------------------+
| Direction | Start Byte | Packet Type | Header     | Payload Length | Payload  | Checksum                    |
+===========+============+=============+============+================+==========+=============================+
| to AC     | 0xFC       | 0x42        | 0x01, 0x30 | 0x10           | 16 Bytes | 0xFC - (Sum(Packet) & 0xFF) |
+-----------+------------+-------------+------------+----------------+----------+-----------------------------+
| from AC   | 0xFC       | 0x62        | 0x01, 0x30 | 0x10           | 16 Bytes | 0xFC - (Sum(Packet) & 0xFF) |
+-----------+------------+-------------+------------+----------------+----------+-----------------------------+

Payloads of Get Data Packet:

+-----------+-----------------------+--------+--------+-----------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+
| Direction | Byte 0 (Request Type) | Byte 1 | Byte 2 | Byte 3    | Byte 4 | Byte 5   | Byte 6 | Byte 7 | Byte 8 | Byte 9 | Byte 10   | Byte 11 | Byte 12 | Byte 13 | Byte 14 | Byte 15 |
+===========+=======================+========+========+===========+========+==========+========+========+========+========+===========+=========+=========+=========+=========+=========+
| to AC     | 0x02                  | 0x00   | 0x00   | 0x00      | 0x00   | 0x00     | 0x00   | 0x00   | 0x00   | 0x00   | 0x00      | 0x00    | 0x00    | 0x00    | 0x00    | 0x00    |
+-----------+-----------------------+--------+--------+-----------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+
| from AC   | 0x02                  | 0x00   | 0x00   | power     | mode   | temp set | fan    | vane   | 0x00   | 0x00   | direction | ?       | ?       | 0x00    | 0x00    | 0x00    |
+-----------+-----------------------+--------+--------+-----------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+
| to AC     | 0x03                  | 0x00   | 0x00   | 0x00      | 0x00   | 0x00     | 0x00   | 0x00   | 0x00   | 0x00   | 0x00      | 0x00    | 0x00    | 0x00    | 0x00    | 0x00    |
+-----------+-----------------------+--------+--------+-----------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+
| from AC   | 0x03                  | 0x00   | 0x00   | temp room | 0x00   | 0x00     | 0x00   | 0x00   | 0x00   | 0x00   | 0x00      | 0x00    | 0x00    | 0x00    | 0x00    | 0x00    |
+-----------+-----------------------+--------+--------+-----------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+

Example: 

Read the state of the AC

+-----------+------------+-------------+------------+----------------+------------------------------------------------------------------------------------------------+----------+
| Direction | Start Byte | Packet Type | Header     | Payload Length | Payload                                                                                        | Checksum |
+===========+============+=============+============+================+================================================================================================+==========+
| to AC     | 0xFC       | 0x41        | 0x01, 0x30 | 0x10           | 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 | 0x7B     |
+-----------+------------+-------------+------------+----------------+------------------------------------------------------------------------------------------------+----------+
| from AC   | 0xFC       | 0x61        | 0x01, 0x30 | 0x10           | 0x02, 0x00, 0x00, 0x01, 0x01, 0x0E, 0x00, 0x07, 0x00, 0x00, 0x03, 0xA2, 0x32, 0x00, 0x00, 0x00 | 0x6D     |
+-----------+------------+-------------+------------+----------------+------------------------------------------------------------------------------------------------+----------+

That means:

* Power: 0x01 (ON)
* Mode: 0x01 (HEAT)
* Temp: 0x0E (17Â°C)
* Fan: 0x00 (AUTO)
* Vane: 0x07 (SWING)
* Dir: 0x03 (\|)

Set Data
--------

Set state of AC:

+-----------+------------+-------------+------------+----------------+----------+-----------------------------+
| Direction | Start Byte | Packet Type | Header     | Payload Length | Payload  | Checksum                    |
+===========+============+=============+============+================+==========+=============================+
| to AC     | 0xFC       | 0x41        | 0x01, 0x30 | 0x10           | 16 Bytes | 0xFC - (Sum(Packet) & 0xFF) |
+-----------+------------+-------------+------------+----------------+----------+-----------------------------+
| from AC   | 0xFC       | 0x61        | 0x01, 0x30 | 0x10           | 16 Bytes | 0xFC - (Sum(Packet) & 0xFF) |
+-----------+------------+-------------+------------+----------------+----------+-----------------------------+

Payloads of Set Data Packet:

+-----------+-----------------------+-------------+--------+--------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+
| Direction | Byte 0 (Request Type) | Byte 1      | Byte 2 | Byte 3 | Byte 4 | Byte 5   | Byte 6 | Byte 7 | Byte 8 | Byte 9 | Byte 10   | Byte 11 | Byte 12 | Byte 13 | Byte 14 | Byte 15 |
+===========+=======================+=============+========+========+========+==========+========+========+========+========+===========+=========+=========+=========+=========+=========+
| to AC     | 0x01                  | what is set | 0x00   | power  | mode   | temp set | fan    | vane   | 0x00   | 0x00   | direction | 0x00    | 0x00    | 0x00    | 0x00    | 0x00    |
+-----------+-----------------------+-------------+--------+--------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+
| from AC   | 0x00                  | 0x00        | 0x00   | 0x00   | 0x00   | 0x00     | 0x00   | 0x00   | 0x00   | 0x00   | 0x00      | 0x00    | 0x00    | 0x00    | 0x00    | 0x00    |
+-----------+-----------------------+-------------+--------+--------+--------+----------+--------+--------+--------+--------+-----------+---------+---------+---------+---------+---------+

Byte 1 if the Set Data Packet is bitwise encoded:

+-----+---------------------------------------+
| Bit | Meaning                               |
+=====+=======================================+
| 0   | Power state is written in this packet |
+-----+---------------------------------------+
| 1   | Mode is written in this packet        |
+-----+---------------------------------------+
| 2   | Temperature is written in this packet |
+-----+---------------------------------------+
| 3   | Fan is written in this packet         |
+-----+---------------------------------------+
| 4   | Vane is written in this packet        |
+-----+---------------------------------------+
| 7   | Direction is written in this packet   |
+-----+---------------------------------------+

Example: 

If you want to set the mode to heat and let the rest unchanged, the communication would look like this:

+-----------+------------+-------------+------------+----------------+------------------------------------------------------------------------------------------------+----------+
| Direction | Start Byte | Packet Type | Header     | Payload Length | Payload                                                                                        | Checksum |
+===========+============+=============+============+================+================================================================================================+==========+
| to AC     | 0xFC       | 0x41        | 0x01, 0x30 | 0x10           | 0x01, 0x02, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 | 0x7A     |
+-----------+------------+-------------+------------+----------------+------------------------------------------------------------------------------------------------+----------+
| from AC   | 0xFC       | 0x61        | 0x01, 0x30 | 0x10           | 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 | 0x5E     |
+-----------+------------+-------------+------------+----------------+------------------------------------------------------------------------------------------------+----------+